<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - EcoMarket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .test-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
        }
        .test-result {
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <div class="container test-container">
        <h1 class="text-center mb-4">🧪 Test del Sistema EcoMarket</h1>
        
        <div class="card">
            <div class="card-body">
                <h3>Pruebas de Funcionalidad</h3>
                <div id="test-results"></div>
                
                <hr>
                
                <h4>Enlaces de Navegación</h4>
                <div class="d-grid gap-2">
                    <a href="index.html" class="btn btn-primary">🏠 Página Principal</a>
                    <a href="login.html" class="btn btn-success">🔐 Login (Probar admin/1234)</a>
                    <a href="catalogo.html" class="btn btn-info">📦 Catálogo de Productos</a>
                    <a href="admin.html" class="btn btn-warning">⚙️ Panel Admin</a>
                    <a href="carrito.html" class="btn btn-secondary">🛒 Carrito de Compras</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tests básicos del sistema
        function runTests() {
            const results = document.getElementById('test-results');
            const tests = [];

            // Test 1: Verificar localStorage
            try {
                localStorage.setItem('test', 'value');
                localStorage.removeItem('test');
                tests.push({ name: 'LocalStorage', status: 'success', message: '✅ LocalStorage funcionando correctamente' });
            } catch (e) {
                tests.push({ name: 'LocalStorage', status: 'error', message: '❌ Error en LocalStorage: ' + e.message });
            }

            // Test 2: Verificar estructura de productos
            const products = localStorage.getItem('ecomarket_products');
            if (products) {
                try {
                    const parsedProducts = JSON.parse(products);
                    if (Array.isArray(parsedProducts) && parsedProducts.length > 0) {
                        tests.push({ name: 'Productos', status: 'success', message: `✅ ${parsedProducts.length} productos en localStorage` });
                    } else {
                        tests.push({ name: 'Productos', status: 'error', message: '❌ No hay productos válidos en localStorage' });
                    }
                } catch (e) {
                    tests.push({ name: 'Productos', status: 'error', message: '❌ Error al parsear productos: ' + e.message });
                }
            } else {
                tests.push({ name: 'Productos', status: 'error', message: '⚠️ No se encontraron productos en localStorage' });
            }

            // Test 3: Verificar autenticación
            const authStatus = localStorage.getItem('ecomarket_auth_status');
            const currentUser = localStorage.getItem('ecomarket_current_user');
            tests.push({ 
                name: 'Autenticación', 
                status: authStatus ? 'success' : 'error', 
                message: authStatus ? `✅ Usuario autenticado: ${currentUser}` : '⚠️ No hay usuario autenticado'
            });

            // Test 4: Verificar carrito
            const cart = localStorage.getItem('ecomarket_cart');
            if (cart) {
                try {
                    const parsedCart = JSON.parse(cart);
                    tests.push({ name: 'Carrito', status: 'success', message: `✅ Carrito: ${parsedCart.length} items` });
                } catch (e) {
                    tests.push({ name: 'Carrito', status: 'error', message: '❌ Error en carrito: ' + e.message });
                }
            } else {
                tests.push({ name: 'Carrito', status: 'success', message: '✅ Carrito vacío (normal)' });
            }

            // Mostrar resultados
            results.innerHTML = tests.map(test => 
                `<div class="test-result ${test.status}">
                    <strong>${test.name}:</strong> ${test.message}
                </div>`
            ).join('');
        }

        // Ejecutar tests al cargar
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>