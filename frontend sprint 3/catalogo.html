<!DOCTYPE html>
<html lang="es">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo - EcoMarket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    </head>
    <body>

    <!-- NAVBAR (reutilizada del index) -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #008c5a;">
        <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="index.html">EcoMarket</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
            <li class="nav-item"><a class="nav-link active" href="catalogo.html">Catálogo</a></li>
            <li class="nav-item"><a class="nav-link" href="nosotros.html">Nosotros</a></li>
            <li class="nav-item"><a class="nav-link" href="contacto.html">Contacto</a></li>
            </ul>

            <!-- Iconos -->
            <div class="d-flex align-items-center gap-3">
            <a href="login.html" class="text-white"><i class="bi bi-person fs-5"></i></a>
            <a href="#" class="text-white position-relative">
                <i class="bi bi-cart fs-5"></i>
                <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
            </a>
            </div>
        </div>
        </div>
    </nav>

    <!-- Banner -->
    <section class="py-5 text-center bg-light">
        <h1 class="fw-bold">Catálogo de productos</h1>
        <p class="text-muted">Encuentra lo que necesitas para tu mesa fresca y saludable</p>
    </section>

    <!-- Filtros -->
    <div class="container my-4">
        <div class="row">
        <!-- Sidebar filtros -->
        <aside class="col-lg-3 mb-4">
            <div class="card shadow-sm">
            <div class="card-header bg-success text-white fw-bold">Filtros</div>
            <div class="card-body">
                <h6>Categorías</h6>
                <ul class="list-unstyled">
                <li><input type="checkbox" class="form-check-input me-2" id="categoria-frutas" value="frutas"> <label for="categoria-frutas">Frutas</label></li>
                <li><input type="checkbox" class="form-check-input me-2" id="categoria-verduras" value="verduras"> <label for="categoria-verduras">Verduras</label></li>
                <li><input type="checkbox" class="form-check-input me-2" id="categoria-despensa" value="despensa"> <label for="categoria-despensa">Despensa</label></li>
                <li><input type="checkbox" class="form-check-input me-2" id="categoria-ofertas" value="ofertas"> <label for="categoria-ofertas">Ofertas</label></li>
                </ul>
                <hr>
                <h6>Rango de precios</h6>
                <input type="range" class="form-range" min="500" max="5000" step="100">
                <div class="d-flex justify-content-between">
                <span>$500</span><span>$5000</span>
                </div>
                <hr>
                <button class="btn btn-success w-100 mb-2">Aplicar filtros</button>
                <button class="btn btn-outline-secondary w-100">Limpiar filtros</button>
            </div>
            </div>
        </aside>

        <!-- Grid productos -->
        <section class="col-lg-9">
            <div class="row g-4" id="productos-lista">
            <!-- Producto ejemplo -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                <img src="https://via.placeholder.com/250x150" class="card-img-top" alt="Producto">
                <div class="card-body">
                    <h5 class="card-title">Producto ejemplo</h5>
                    <p class="card-text text-muted">Descripción breve</p>
                    <p class="fw-bold text-success">$1.500</p>
                    <button class="btn btn-success w-100">
                    <i class="bi bi-cart-plus"></i> Agregar
                    </button>
                </div>
                </div>
            </div>
            <!-- Más productos se generan dinámicamente en JS -->
            </div>

            <!-- Paginación -->
            <nav aria-label="Page navigation" class="mt-4">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled"><a class="page-link" href="#">Anterior</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">Siguiente</a></li>
            </ul>
            </nav>
        </section>
        </div>
    </div>

    <!-- Footer Container - El footer se carga dinámicamente -->
    <div id="footer-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Función para obtener parámetros de la URL
        function getURLParameter(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Función para aplicar filtros basados en la URL
        function aplicarFiltroURL() {
            const categoria = getURLParameter('categoria');
            
            if (categoria) {
                // Marcar el checkbox correspondiente
                const checkbox = document.getElementById(`categoria-${categoria}`);
                if (checkbox) {
                    checkbox.checked = true;
                    
                    // Actualizar el título para mostrar la categoría filtrada
                    const titulo = document.querySelector('section.py-5 h1');
                    const categoriaCapitalizada = categoria.charAt(0).toUpperCase() + categoria.slice(1);
                    titulo.textContent = `Catálogo - ${categoriaCapitalizada}`;
                    
                    // Agregar clase visual para indicar filtro activo
                    checkbox.parentElement.style.fontWeight = 'bold';
                    checkbox.parentElement.style.color = '#008c5a';
                }
                
                console.log(`Filtro aplicado: ${categoria}`);
            }
        }

        // Función para limpiar todos los filtros
        function limpiarFiltros() {
            // Desmarcar todos los checkboxes
            const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="categoria-"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
                checkbox.parentElement.style.fontWeight = 'normal';
                checkbox.parentElement.style.color = '';
            });
            
            // Restaurar título original
            const titulo = document.querySelector('section.py-5 h1');
            titulo.textContent = 'Catálogo de productos';
            
            // Remover parámetros de la URL sin recargar
            const url = new URL(window.location);
            url.searchParams.delete('categoria');
            window.history.replaceState({}, '', url);
            
            console.log('Filtros limpiados');
        }

        // Función para actualizar URL cuando se cambian filtros
        function actualizarURL() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="categoria-"]:checked');
            const url = new URL(window.location);
            
            // Limpiar parámetros existentes
            url.searchParams.delete('categoria');
            
            // Agregar categorías seleccionadas
            if (checkboxes.length > 0) {
                // Por simplicidad, solo tomamos la primera categoría seleccionada
                const categoria = checkboxes[0].value;
                url.searchParams.set('categoria', categoria);
            }
            
            // Actualizar URL sin recargar
            window.history.replaceState({}, '', url);
        }

        // Event listener para cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            // Aplicar filtros basados en URL
            aplicarFiltroURL();
            
            // Agregar event listeners a los checkboxes
            const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="categoria-"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    // Solo permitir una categoría seleccionada a la vez para mantener URL limpia
                    if (this.checked) {
                        checkboxes.forEach(cb => {
                            if (cb !== this) {
                                cb.checked = false;
                                cb.parentElement.style.fontWeight = 'normal';
                                cb.parentElement.style.color = '';
                            }
                        });
                        
                        // Estilizar la categoría seleccionada
                        this.parentElement.style.fontWeight = 'bold';
                        this.parentElement.style.color = '#008c5a';
                        
                        // Actualizar título
                        const titulo = document.querySelector('section.py-5 h1');
                        const categoriaCapitalizada = this.value.charAt(0).toUpperCase() + this.value.slice(1);
                        titulo.textContent = `Catálogo - ${categoriaCapitalizada}`;
                    } else {
                        // Si se desmarca, restaurar estado normal
                        this.parentElement.style.fontWeight = 'normal';
                        this.parentElement.style.color = '';
                        
                        const titulo = document.querySelector('section.py-5 h1');
                        titulo.textContent = 'Catálogo de productos';
                    }
                    
                    actualizarURL();
                });
            });
            
            // Event listener para botón "Limpiar filtros"
            const btnLimpiar = document.querySelector('.btn-outline-secondary');
            if (btnLimpiar) {
                btnLimpiar.addEventListener('click', function(e) {
                    e.preventDefault();
                    limpiarFiltros();
                });
            }
            
            // Event listener para botón "Aplicar filtros" (futuro desarrollo)
            const btnAplicar = document.querySelector('.btn-success');
            if (btnAplicar && btnAplicar.textContent.includes('Aplicar')) {
                btnAplicar.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Aplicar filtros - función disponible para futuro desarrollo');
                    // Aquí se puede agregar lógica para filtrar productos visualmente
                });
            }
        });
    </script>
    <script src="assets/js/app.js"></script>
    </body>
</html>
