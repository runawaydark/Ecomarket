<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Gesti√≥n de Productos | EcoMarket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    <style>
        .admin-container {
            background: linear-gradient(135deg, #f1f3f4 0%, #e8eaed 100%);
            min-height: 100vh;
            padding: 1rem 0;
        }
        
        .admin-header {
            background: linear-gradient(135deg, #008c5a, #00b374);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1.5rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        /* Responsive styles for mobile */
        @media (max-width: 768px) {
            .admin-container {
                padding: 0.5rem 0;
            }
            
            .admin-header {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .admin-header h1 {
                font-size: 1.5rem !important;
            }
            
            .stats-cards {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 0.5rem;
                margin-bottom: 1rem;
            }
            
            .stat-card {
                padding: 1rem !important;
            }
            
            .stat-icon {
                font-size: 2rem !important;
            }
            
            .stat-number {
                font-size: 1.4rem !important;
            }
            
            .admin-section {
                margin-bottom: 1rem !important;
                padding: 1rem !important;
            }
            
            /* Form responsive adjustments */
            .row .col-md-4,
            .row .col-md-6 {
                margin-bottom: 0.5rem;
            }
            
            .form-label {
                font-size: 0.9rem;
                margin-bottom: 0.3rem;
            }
            
            .form-control {
                font-size: 0.9rem;
                padding: 0.5rem;
            }
            
            .input-group-text {
                font-size: 0.9rem;
                padding: 0.5rem;
            }
            
            /* Product cards responsive */
            .product-card {
                margin-bottom: 1rem;
            }
            
            .product-card .card-body {
                padding: 0.75rem !important;
            }
            
            .product-card h5 {
                font-size: 1rem !important;
            }
            
            .product-card .btn {
                font-size: 0.8rem;
                padding: 0.25rem 0.5rem;
            }
            
            /* Make buttons stack on mobile */
            .btn-group {
                flex-direction: column !important;
                gap: 0.25rem;
            }
            
            .btn-group .btn {
                border-radius: 0.375rem !important;
                margin: 0 !important;
            }
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid rgba(0, 140, 90, 0.1);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #008c5a;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .admin-section {
            background: #ffffff;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid #f1f3f4;
            position: relative;
        }
        
        .admin-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #008c5a 0%, #00a862 100%);
            border-radius: 15px 15px 0 0;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .btn-primary-custom {
            background: linear-gradient(135deg, #008c5a, #00b374);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary-custom:hover {
            background: linear-gradient(135deg, #007a50, #009d66);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 140, 90, 0.3);
        }
        
        .product-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        
        .product-item:hover {
            border-color: #008c5a;
            box-shadow: 0 4px 15px rgba(0, 140, 90, 0.1);
        }
        
        .product-form {
            background: #ffffff;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .form-control {
            background-color: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .form-control:focus {
            background-color: #ffffff;
            border-color: #008c5a;
            box-shadow: 0 0 0 3px rgba(0, 140, 90, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1);
            outline: none;
        }
        
        .form-control:hover {
            border-color: #ced4da;
            background-color: #ffffff;
        }
        
        .form-control::placeholder {
            color: #6c757d;
            opacity: 0.8;
        }
        
        /* Estilos espec√≠ficos para inputs de n√∫meros */
        input[type="number"].form-control {
            background-image: linear-gradient(45deg, transparent 49%, #f8f9fa 49%, #f8f9fa 51%, transparent 51%);
            background-size: 20px 20px;
            background-repeat: no-repeat;
            background-position: right 10px center;
        }
        
        /* Estilos para select */
        select.form-control {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        
        /* Estilos para textarea */
        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }
        
        /* Labels mejorados */
        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
        }
        
        /* Contenedor de campos mejorado */
        .mb-3 {
            position: relative;
        }
        
        /* Estilos para checkboxes mejorados */
        .form-check-input {
            width: 1.2rem;
            height: 1.2rem;
            margin-top: 0.25rem;
            border: 2px solid #dee2e6;
            border-radius: 4px;
            background-color: #ffffff;
        }
        
        .form-check-input:checked {
            background-color: #008c5a;
            border-color: #008c5a;
        }
        
        .form-check-input:focus {
            border-color: #008c5a;
            box-shadow: 0 0 0 3px rgba(0, 140, 90, 0.15);
        }
        
        .form-check-label {
            font-weight: 500;
            color: #495057;
        }
        
        /* Botones mejorados */
        .btn {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="container">
            <!-- Header -->
            <div class="admin-header">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1><i class="bi bi-gear-fill"></i> Panel de Administraci√≥n</h1>
                        <p class="mb-0">Gestiona los productos del cat√°logo EcoMarket</p>
                    </div>
                    <div class="d-flex gap-2">
                        <a href="catalogo.html" class="btn btn-light">
                            <i class="bi bi-eye"></i> Ver Cat√°logo
                        </a>
                        <button class="btn btn-outline-light" onclick="logout()">
                            <i class="bi bi-box-arrow-right"></i> Cerrar Sesi√≥n
                        </button>
                    </div>
                </div>
            </div>

            <!-- Estad√≠sticas -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">üì¶</div>
                    <div class="stat-number" id="total-products">0</div>
                    <div class="stat-label">Total Productos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-number" id="in-stock">0</div>
                    <div class="stat-label">En Stock</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö†Ô∏è</div>
                    <div class="stat-number" id="low-stock">0</div>
                    <div class="stat-label">Poco Stock</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-number" id="avg-price">$0</div>
                    <div class="stat-label">Precio Promedio</div>
                </div>
            </div>

            <!-- Formulario para agregar/editar productos -->
            <div class="admin-section">
                <div class="section-header">
                    <h3><i class="bi bi-plus-circle"></i> Agregar/Editar Producto</h3>
                    <button class="btn btn-secondary" onclick="clearForm()">
                        <i class="bi bi-x-circle"></i> Limpiar Formulario
                    </button>
                </div>
                
                <form class="product-form" id="product-form">
                    <input type="hidden" id="product-id">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Nombre del Producto *</label>
                            <input type="text" class="form-control" id="product-name" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Categor√≠a *</label>
                            <select class="form-control" id="product-category" required>
                                <option value="">Seleccionar categor√≠a</option>
                                <option value="frutas">Frutas</option>
                                <option value="verduras">Verduras</option>
                                <option value="despensa">Despensa</option>
                                <option value="ofertas">Ofertas</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Descripci√≥n *</label>
                        <textarea class="form-control" id="product-description" rows="3" required></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Precio oferta *</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="product-price" required>
                            </div>
                        </div>
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Precio Original</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="product-original-price">
                            </div>
                        </div>
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Unidad *</label>
                            <select class="form-control" id="product-unit" required>
                                <option value="kg">Kilogramo (kg)</option>
                                <option value="unidad">Unidad</option>
                                <option value="litro">Litro</option>
                                <option value="paquete">Paquete</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Stock Actual *</label>
                            <input type="number" class="form-control" id="product-stock" min="0" required>
                        </div>
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Stock M√°ximo *</label>
                            <input type="number" class="form-control" id="product-max-stock" min="1" required>
                        </div>
                        <div class="col-md-4 col-12 mb-3">
                            <label class="form-label">Calificaci√≥n</label>
                            <input type="number" class="form-control" id="product-rating" min="0" max="5" step="0.1" value="4.0">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 col-12 mb-3">
                            <label class="form-label">URL de Imagen</label>
                            <input type="url" class="form-control" id="product-image" placeholder="https://ejemplo.com/imagen.jpg">
                        </div>
                        <div class="col-md-6 col-12 mb-3">
                            <label class="form-label">N√∫mero de Rese√±as</label>
                            <input type="number" class="form-control" id="product-reviews" min="0" value="0">
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6 col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="product-is-new">
                                <label class="form-check-label" for="product-is-new">
                                    Producto Nuevo
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6 col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="product-available" checked>
                                <label class="form-check-label" for="product-available">
                                    Disponible
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary-custom">
                        <i class="bi bi-save"></i> <span id="form-btn-text">Guardar Producto</span>
                    </button>
                </form>
            </div>

            <!-- Lista de productos existentes -->
            <div class="admin-section">
                <div class="section-header">
                    <h3><i class="bi bi-list-ul"></i> Productos Existentes</h3>
                    <button class="btn btn-warning" onclick="resetToDefaults()">
                        <i class="bi bi-arrow-clockwise"></i> Restaurar Valores por Defecto
                    </button>
                </div>
                
                <div id="products-list">
                    <!-- Los productos se cargan din√°micamente aqu√≠ -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sistema de administraci√≥n de productos
        let isEditing = false;
        
        // Obtener productos del localStorage
        function getProducts() {
            const products = localStorage.getItem('ecomarket_products');
            return products ? JSON.parse(products) : [];
        }
        
        // Guardar productos en localStorage
        function saveProducts(products) {
            localStorage.setItem('ecomarket_products', JSON.stringify(products));
            // Trigger evento para actualizar cat√°logo
            window.dispatchEvent(new CustomEvent('productsUpdated', { detail: products }));
        }
        
        // Generar ID √∫nico para nuevo producto
        function generateId() {
            return 'prod_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Actualizar estad√≠sticas
        function updateStats() {
            const products = getProducts();
            const totalProducts = products.length;
            const inStock = products.filter(p => p.stock > 5).length;
            const lowStock = products.filter(p => p.stock <= 5 && p.stock > 0).length;
            const avgPrice = products.length > 0 ? 
                Math.round(products.reduce((sum, p) => sum + p.price, 0) / products.length) : 0;
            
            document.getElementById('total-products').textContent = totalProducts;
            document.getElementById('in-stock').textContent = inStock;
            document.getElementById('low-stock').textContent = lowStock;
            document.getElementById('avg-price').textContent = `$${avgPrice.toLocaleString()}`;
        }
        
        // Renderizar lista de productos
        function renderProductsList() {
            const products = getProducts();
            const container = document.getElementById('products-list');
            
            if (products.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-muted py-5">
                        <i class="bi bi-inbox" style="font-size: 3rem;"></i>
                        <h5>No hay productos registrados</h5>
                        <p>Agrega tu primer producto usando el formulario de arriba</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = products.map(product => `
                <div class="product-item">
                    <div class="row align-items-center">
                        <div class="col-md-2">
                            <img src="${product.image || 'https://via.placeholder.com/80x60/008c5a/ffffff?text=Sin+Img'}" 
                                 class="img-fluid rounded" alt="${product.name}" style="height: 60px; object-fit: cover;">
                        </div>
                        <div class="col-md-3">
                            <h6 class="mb-1">${product.name}</h6>
                            <span class="badge bg-secondary">${product.category}</span>
                        </div>
                        <div class="col-md-2">
                            <div class="fw-bold text-success">$${product.price.toLocaleString()}</div>
                            <small class="text-muted">por ${product.unit}</small>
                        </div>
                        <div class="col-md-2">
                            <div class="d-flex align-items-center">
                                <span class="me-2">${product.stock}</span>
                                <div class="progress" style="width: 60px; height: 8px;">
                                    <div class="progress-bar ${product.stock > 5 ? 'bg-success' : 'bg-warning'}" 
                                         style="width: ${(product.stock / product.maxStock) * 100}%"></div>
                                </div>
                            </div>
                            <small class="text-muted">de ${product.maxStock}</small>
                        </div>
                        <div class="col-md-1 text-center">
                            <span class="badge ${product.available ? 'bg-success' : 'bg-secondary'}">
                                ${product.available ? 'Activo' : 'Inactivo'}
                            </span>
                        </div>
                        <div class="col-md-2 text-end">
                            <button class="btn btn-sm btn-outline-primary me-1" onclick="editProduct('${product.id}')">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct('${product.id}')">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Limpiar formulario
        function clearForm() {
            document.getElementById('product-form').reset();
            document.getElementById('product-id').value = '';
            document.getElementById('product-available').checked = true;
            document.getElementById('product-rating').value = 4.0;
            document.getElementById('product-reviews').value = 0;
            document.getElementById('form-btn-text').textContent = 'Guardar Producto';
            isEditing = false;
        }
        
        // Editar producto
        function editProduct(productId) {
            const products = getProducts();
            const product = products.find(p => p.id === productId);
            
            if (!product) return;
            
            document.getElementById('product-id').value = product.id;
            document.getElementById('product-name').value = product.name;
            document.getElementById('product-category').value = product.category;
            document.getElementById('product-description').value = product.description;
            document.getElementById('product-price').value = product.price;
            document.getElementById('product-original-price').value = product.originalPrice || '';
            document.getElementById('product-unit').value = product.unit;
            document.getElementById('product-stock').value = product.stock;
            document.getElementById('product-max-stock').value = product.maxStock;
            document.getElementById('product-rating').value = product.rating;
            document.getElementById('product-image').value = product.image || '';
            document.getElementById('product-reviews').value = product.reviews;
            document.getElementById('product-is-new').checked = product.isNew;
            document.getElementById('product-available').checked = product.available;
            
            document.getElementById('form-btn-text').textContent = 'Actualizar Producto';
            isEditing = true;
            
            // Scroll al formulario
            document.getElementById('product-form').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Eliminar producto
        function deleteProduct(productId) {
            if (!confirm('¬øEst√°s seguro de que deseas eliminar este producto?')) return;
            
            const products = getProducts();
            const updatedProducts = products.filter(p => p.id !== productId);
            saveProducts(updatedProducts);
            renderProductsList();
            updateStats();
            
            alert('Producto eliminado correctamente');
        }
        
        // Restaurar productos por defecto
        function resetToDefaults() {
            if (!confirm('¬øEst√°s seguro? Esto eliminar√° todos los productos actuales y restaurar√° los valores por defecto.')) return;
            
            // Productos por defecto (mismos que en catalog.js)
            const defaultProducts = [
                {
                    id: 'frutillas',
                    name: 'Frutillas Frescas Premium',
                    category: 'frutas',
                    description: 'Frutillas de temporada, dulces y jugosas. Perfectas para postres y desayunos saludables.',
                    price: 1600,
                    originalPrice: 2000,
                    unit: 'kg',
                    stock: 15,
                    maxStock: 20,
                    image: 'assets/img/frutillas.jpg',
                    rating: 4.5,
                    reviews: 24,
                    isNew: false,
                    isOffer: true,
                    available: true
                },
                {
                    id: 'lechuga',
                    name: 'Lechuga Criolla Fresca',
                    category: 'verduras',
                    description: 'Lechuga criolla de hoja verde, crujiente y fresca. Ideal para ensaladas y hamburguesas.',
                    price: 1200,
                    originalPrice: null,
                    unit: 'unidad',
                    stock: 25,
                    maxStock: 30,
                    image: 'assets/img/lechuga.jpg',
                    rating: 4.0,
                    reviews: 18,
                    isNew: false,
                    isOffer: false,
                    available: true
                },
                {
                    id: 'tomates',
                    name: 'Tomates Cherry Org√°nicos',
                    category: 'verduras',
                    description: 'Tomates cherry org√°nicos, dulces y jugosos. Perfectos para ensaladas y snacks saludables.',
                    price: 2800,
                    originalPrice: null,
                    unit: 'kg',
                    stock: 3,
                    maxStock: 20,
                    image: 'assets/img/tomates.jpg',
                    rating: 5.0,
                    reviews: 32,
                    isNew: false,
                    isOffer: false,
                    available: true
                },
                {
                    id: 'zanahorias',
                    name: 'Zanahorias Baby Premium',
                    category: 'verduras',
                    description: 'Zanahorias baby tiernas y dulces. Ideales para cocinar o consumir crudas como snack saludable.',
                    price: 1800,
                    originalPrice: null,
                    unit: 'kg',
                    stock: 20,
                    maxStock: 25,
                    image: 'assets/img/zanahoria.jpg',
                    rating: 4.2,
                    reviews: 12,
                    isNew: true,
                    isOffer: false,
                    available: true
                }
            ];
            
            saveProducts(defaultProducts);
            renderProductsList();
            updateStats();
            clearForm();
            
            alert('Productos restaurados a valores por defecto');
        }
        
        // Manejar env√≠o del formulario
        document.getElementById('product-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: document.getElementById('product-id').value || generateId(),
                name: document.getElementById('product-name').value.trim(),
                category: document.getElementById('product-category').value,
                description: document.getElementById('product-description').value.trim(),
                price: parseInt(document.getElementById('product-price').value),
                originalPrice: document.getElementById('product-original-price').value ? 
                              parseInt(document.getElementById('product-original-price').value) : null,
                unit: document.getElementById('product-unit').value,
                stock: parseInt(document.getElementById('product-stock').value),
                maxStock: parseInt(document.getElementById('product-max-stock').value),
                rating: parseFloat(document.getElementById('product-rating').value),
                image: document.getElementById('product-image').value.trim() || null,
                reviews: parseInt(document.getElementById('product-reviews').value) || 0,
                isNew: document.getElementById('product-is-new').checked,
                available: document.getElementById('product-available').checked
            };
            
            // Validaciones b√°sicas
            if (formData.price <= 0) {
                alert('El precio debe ser mayor a 0');
                return;
            }
            
            if (formData.stock > formData.maxStock) {
                alert('El stock actual no puede ser mayor al stock m√°ximo');
                return;
            }
            
            // Calcular si es oferta
            formData.isOffer = formData.originalPrice && formData.originalPrice > formData.price;
            
            const products = getProducts();
            
            if (isEditing) {
                // Actualizar producto existente
                const index = products.findIndex(p => p.id === formData.id);
                if (index !== -1) {
                    products[index] = formData;
                    alert('Producto actualizado correctamente');
                }
            } else {
                // Agregar nuevo producto
                products.push(formData);
                alert('Producto agregado correctamente');
            }
            
            saveProducts(products);
            renderProductsList();
            updateStats();
            clearForm();
        });
        
        // Funci√≥n para cerrar sesi√≥n
        function logout() {
            if (confirm('¬øEst√°s seguro de que deseas cerrar sesi√≥n?')) {
                localStorage.removeItem('ecomarket_logged_in');
                localStorage.removeItem('ecomarket_user_type');
                localStorage.removeItem('ecomarket_user_email');
                localStorage.removeItem('ecomarket_user_name');
                
                alert('Sesi√≥n cerrada correctamente');
                window.location.href = 'login.html';
            }
        }
        
        // Verificar autenticaci√≥n
        function checkAuth() {
            const isLoggedIn = localStorage.getItem('ecomarket_logged_in') === 'true';
            const userType = localStorage.getItem('ecomarket_user_type');
            
            if (!isLoggedIn || userType !== 'admin') {
                alert('Acceso denegado. Debes iniciar sesi√≥n como administrador.');
                window.location.href = 'login.html';
                return false;
            }
            return true;
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar autenticaci√≥n antes de cargar el panel
            if (!checkAuth()) {
                return;
            }
            
            renderProductsList();
            updateStats();
            
            // Mostrar informaci√≥n del usuario logueado
            const userEmail = localStorage.getItem('ecomarket_user_email');
            if (userEmail) {
                console.log('Panel de administraci√≥n inicializado para:', userEmail);
            }
        });
    </script>
</body>
</html>
